# Cursuri Project - Visual Architecture Map
**Generated**: October 15, 2025

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          CURSURI ARCHITECTURE MAP                            │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                              CLIENT LAYER                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                       Next.js 15 App Router                           │  │
│  │  ┌────────────┬────────────┬────────────┬────────────┬───────────┐  │  │
│  │  │  Homepage  │  Courses   │  Profile   │   Admin    │   APIs    │  │  │
│  │  │  (/)       │ (/courses) │ (/profile) │  (/admin)  │  (/api)   │  │  │
│  │  └────────────┴────────────┴────────────┴────────────┴───────────┘  │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                    React 19 Components (60+)                          │  │
│  │  ┌─────────────────┬──────────────────┬──────────────────────────┐  │  │
│  │  │   UI Layer      │  Feature Layer   │     State Layer          │  │  │
│  │  │  • Buttons      │  • Course.tsx    │  • AppContext.tsx        │  │  │
│  │  │  • Modals       │  • Lesson.tsx    │    (1830 lines ⚠️)       │  │  │
│  │  │  • Forms        │  • Admin/        │  • modalContext.tsx      │  │  │
│  │  │  • Cards        │  • Profile/      │  • useModal hook         │  │  │
│  │  │  • HeroUI       │  • Reviews.tsx   │                          │  │  │
│  │  └─────────────────┴──────────────────┴──────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                     Styling & Animation                               │  │
│  │  ┌────────────────────────┬──────────────────────────────────────┐  │  │
│  │  │  TailwindCSS 4.1.3     │  Framer Motion 12.6.3                │  │  │
│  │  │  • Custom themes       │  • Page transitions                  │  │  │
│  │  │  • Dark/Light mode     │  • Component animations              │  │  │
│  │  │  • Responsive design   │  • Micro-interactions                │  │  │
│  │  └────────────────────────┴──────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           BACKEND SERVICES LAYER                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                    Firebase Services                                  │  │
│  │  ┌────────────────┬─────────────────┬─────────────────────────────┐  │  │
│  │  │  Firestore     │  Authentication │       Storage               │  │  │
│  │  │  • courses/    │  • Email/Pass   │  • Course images            │  │  │
│  │  │    - lessons/  │  • User profiles│  • Video files              │  │  │
│  │  │    - reviews/  │  • Sessions     │  • Documents                │  │  │
│  │  │  • users/      │  • Admin roles  │  • Captions (WebVTT)        │  │  │
│  │  │    - progress/ │                 │                             │  │  │
│  │  │    - bookmarks/│                 │                             │  │  │
│  │  │  • customers/  │  🚨 SECURITY    │  🚨 SECURITY                │  │  │
│  │  │    - payments/ │  Hardcoded      │  Hardcoded admin            │  │  │
│  │  │  • products/   │  admin email!   │  email in rules!            │  │  │
│  │  └────────────────┴─────────────────┴─────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                    Payment Processing                                 │  │
│  │  ┌───────────────────────────────────────────────────────────────┐  │  │
│  │  │  Stripe via Firewand 0.5.19                                    │  │  │
│  │  │  • Checkout Sessions  • Webhooks  • Payment Records            │  │  │
│  │  │  • Product Sync       • Subscriptions (future)                 │  │  │
│  │  └───────────────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                    Azure Speech Service                               │  │
│  │  ┌───────────────────────────────────────────────────────────────┐  │  │
│  │  │  Speech-to-Text & Translation                                  │  │  │
│  │  │  • Automatic caption generation  • Multi-language support      │  │  │
│  │  │  • WebVTT format output          • 10 languages supported      │  │  │
│  │  │  🚨 SECURITY: API key exposed in .env.local!                   │  │  │
│  │  └───────────────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                              API ROUTES LAYER                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────┬──────────────────────┬────────────────────┐   │
│  │  POST /api/captions     │  POST /api/certificate│ POST /api/invoice  │   │
│  │  Azure Speech           │  PDF Generation       │ Invoice PDF        │   │
│  │  Caption generation     │  Course completion    │ User downloads     │   │
│  └─────────────────────────┴──────────────────────┴────────────────────┘   │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  GET /api/sync-lesson                                                │   │
│  │  Lesson synchronization utility                                      │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                         DATA FLOW & STATE MANAGEMENT                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  User Action → Component → AppContext → Firebase → Response                 │
│                                ↓                                             │
│                          useReducer                                          │
│                         (appReducer.ts)                                      │
│                                ↓                                             │
│                        Cache Layer                                           │
│                    (localStorage + memory)                                   │
│                                ↓                                             │
│                       Re-render UI                                           │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │  Cache Strategy (Advanced Implementation)                            │  │
│  │  • Request deduplication   • TTL-based expiration                    │  │
│  │  • localStorage persistence • Loading state tracking                 │  │
│  │  • Per-resource cache keys  • Explicit cache management              │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                          SECURITY ARCHITECTURE                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │  🚨 CRITICAL VULNERABILITIES FOUND (3)                                │  │
│  │  ┌────────────────────────────────────────────────────────────────┐  │  │
│  │  │  1. Hardcoded Admin Email (CVE 9.1)                            │  │  │
│  │  │     vladulescu.catalin@gmail.com in security rules             │  │  │
│  │  │  2. Exposed API Keys (CVE 8.9)                                 │  │  │
│  │  │     Azure Speech key + Firebase keys in repo                   │  │  │
│  │  │  3. Weak Password Policy (CVE 7.8)                             │  │  │
│  │  │     Only 6 chars min, no complexity requirements               │  │  │
│  │  └────────────────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │  Firestore Security Rules                                            │  │
│  │  • courses: public read, admin write                                 │  │
│  │  • lessons: public read (should be purchase-gated)                   │  │
│  │  • users: owner + admin access                                       │  │
│  │  • customers: owner + admin access                                   │  │
│  │  🚨 ISSUE: Email-based admin check (not role-based)                 │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │  Authentication Flow                                                  │  │
│  │  1. User enters credentials → 2. Firebase Auth validates             │  │
│  │  3. Token stored in session → 4. AppContext loads user data          │  │
│  │  5. Admin check (email-based ⚠️) → 6. Redirect to dashboard          │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                            TESTING ARCHITECTURE                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │  Jest + React Testing Library                                        │  │
│  │  Current Coverage: ~40% | Target: 80%                                │  │
│  │  ┌────────────────────┬────────────────────┬───────────────────┐    │  │
│  │  │  Unit Tests        │  Integration Tests │  E2E Tests        │    │  │
│  │  │  ✅ UI components  │  ⚠️ Limited        │  ⚠️ Minimal       │    │  │
│  │  │  ✅ Utilities      │  ❌ Payment flow   │  ❌ User journeys │    │  │
│  │  │  ✅ Helpers        │  ❌ Auth workflow  │  ❌ Admin tasks   │    │  │
│  │  └────────────────────┴────────────────────┴───────────────────┘    │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │  Playwright (E2E)                                                     │  │
│  │  • Configured but underutilized                                      │  │
│  │  • Ready for comprehensive E2E test suite                            │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                            DEPLOYMENT PIPELINE                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │  ❌ CI/CD NOT IMPLEMENTED                                            │  │
│  │  ┌────────────────────────────────────────────────────────────────┐  │  │
│  │  │  Missing:                                                       │  │  │
│  │  │  • GitHub Actions workflow                                      │  │  │
│  │  │  • Automated testing on PR                                      │  │  │
│  │  │  • Automated deployment                                         │  │  │
│  │  │  • Pre-commit hooks (Husky configured but empty)                │  │  │
│  │  │  • Branch protection rules                                      │  │  │
│  │  └────────────────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │  Current Manual Deployment                                           │  │
│  │  Developer → npm run build → Vercel Deploy → Production              │  │
│  │  🚨 No automated quality checks or safety nets!                      │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                          PERFORMANCE METRICS                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Lighthouse Score (Estimated): 70-75/100                                    │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │  Metric                    Current    Target    Status               │  │
│  │  ────────────────────────────────────────────────────────────────    │  │
│  │  First Contentful Paint    1.8s       <1.5s     ⚠️ Needs Improvement │  │
│  │  Time to Interactive       3.2s       <3.0s     ✅ Acceptable        │  │
│  │  Largest Contentful Paint  2.5s       <2.0s     ⚠️ Needs Improvement │  │
│  │  Cumulative Layout Shift   <0.1       <0.1      ✅ Good              │  │
│  │  Bundle Size               ~500KB     <350KB    ⚠️ Too Large         │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  ⚠️ Performance Bottlenecks:                                                │
│  • AppContext.tsx too large (1830 lines)                                    │
│  • No code splitting on admin routes                                        │
│  • Heavy dependencies loaded upfront                                        │
│  • Missing lazy loading for components                                      │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           PRIORITY ACTION MATRIX                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  PRIORITY 1 (CRITICAL - 1-2 weeks)                                          │
│  ┌─────────────────────────────────────────────────────────────┐           │
│  │ 🚨 SECURITY HARDENING                                        │           │
│  │  • Implement RBAC system (remove hardcoded admin)            │           │
│  │  • Fix API key exposure (rotate all keys)                    │           │
│  │  • Strengthen password policy (12+ chars, complexity)        │           │
│  │  • Add security headers (CSP, HSTS, X-Frame-Options)         │           │
│  └─────────────────────────────────────────────────────────────┘           │
│                                                                              │
│  PRIORITY 2 (HIGH - 1-2 weeks)                                              │
│  ┌─────────────────────────────────────────────────────────────┐           │
│  │ 🔧 CI/CD & TESTING                                           │           │
│  │  • Create GitHub Actions pipeline                            │           │
│  │  • Expand test coverage to 80%                               │           │
│  │  • Configure Husky pre-commit hooks                          │           │
│  │  • Add automated deployment                                  │           │
│  └─────────────────────────────────────────────────────────────┘           │
│                                                                              │
│  PRIORITY 3 (MEDIUM - 1-2 weeks)                                            │
│  ┌─────────────────────────────────────────────────────────────┐           │
│  │ ⚡ PERFORMANCE OPTIMIZATION                                  │           │
│  │  • Refactor AppContext (split into smaller contexts)         │           │
│  │  • Implement code splitting                                  │           │
│  │  • Add lazy loading                                          │           │
│  │  • Optimize Firebase queries                                 │           │
│  └─────────────────────────────────────────────────────────────┘           │
│                                                                              │
│  PRIORITY 4 (LOW - Ongoing)                                                 │
│  ┌─────────────────────────────────────────────────────────────┐           │
│  │ 📚 DOCUMENTATION                                             │           │
│  │  • Add JSDoc comments                                        │           │
│  │  • Create architecture diagrams                              │           │
│  │  • Write developer onboarding guide                          │           │
│  │  • Document API endpoints                                    │           │
│  └─────────────────────────────────────────────────────────────┘           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                          PROJECT HEALTH DASHBOARD                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Overall Score: 75/100                                                       │
│  ═══════════════════════════════════════════════════════════════════        │
│                                                                              │
│  ✅ Functionality:        [████████████████████] 95%  Excellent             │
│  ✅ Architecture:         [████████████████    ] 80%  Good                  │
│  ✅ Code Quality:         [███████████████     ] 75%  Good                  │
│  ⚠️  Security:            [██████████          ] 50%  Needs Work            │
│  ⚠️  Performance:         [██████████████      ] 70%  Acceptable            │
│  ❌ CI/CD:                [                    ]  0%  Not Implemented        │
│  ⚠️  Testing:             [████████            ] 40%  Incomplete            │
│  ✅ Documentation:        [████████████        ] 60%  Adequate              │
│                                                                              │
│  Status: FUNCTIONAL (Production-ready after security fixes)                 │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                         TIMELINE TO PRODUCTION                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Week 1-2: 🚨 CRITICAL SECURITY FIXES                                       │
│    └─ Implement RBAC, fix API exposure, strengthen passwords                │
│                                                                              │
│  Week 3-4: 🔧 CI/CD & TESTING                                               │
│    └─ GitHub Actions, expand tests, pre-commit hooks                        │
│                                                                              │
│  Week 5-6: ⚡ PERFORMANCE OPTIMIZATION                                      │
│    └─ Code splitting, refactor AppContext, optimize queries                 │
│                                                                              │
│  Week 7-8: 📚 DOCUMENTATION & POLISH                                        │
│    └─ API docs, deployment guide, final security audit                      │
│                                                                              │
│  TOTAL: 8 weeks to production-ready state                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                              LEGEND & NOTES                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ✅ Complete / Good status                                                  │
│  ⚠️  Needs attention / Partial                                              │
│  ❌ Missing / Critical issue                                                │
│  🚨 Security concern                                                        │
│  ⚡ Performance related                                                     │
│  🔧 Infrastructure / tooling                                                │
│  📚 Documentation                                                           │
│                                                                              │
│  For detailed information, see:                                             │
│  • PROJECT_ANALYSIS_2025-10-15.md - Full analysis                           │
│  • SECURITY_AUDIT_PHASE_2.md - Security vulnerabilities                     │
│  • AGENT_HANDOFF_CONTEXT.md - Quick reference for next agent                │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```
